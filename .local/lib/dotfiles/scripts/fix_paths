#!/bin/sh
# This script is almost pointless, but it originally processed more variables
direction="$1"
shift || exit 1
exp=$(printf 'HOME' | awk -vdirection="$direction" '{
	generic_path = "/path/to/" tolower($0)
	if (direction == "deploy")
		print "-es@" generic_path "@" ENVIRON[$0] "@g"
	else
		print "-es@" ENVIRON[$0] "@" generic_path "@g"
}')
grep -El "$(echo "$exp" | awk -vORS= -vFS=@ '{if(NR!=1)print "|";print $2}')" "$@" | while read -r f; do
	echo "Correcting paths in $f"
	cp -p "$f" "$f.fixed"
	sed "$exp" "$f" > "$f.fixed"
	mv "$f.fixed" "$f"
done
